{
    "input": "How do the runtimes and iteration counts of NFPA and FPSA compare to GMRES and DSA in the numerical experiments?",
    "context": "\\section{Introduction}\\label{sec1}\n\\setcounter{equation}{0} \n\nTransport problems with highly forward-peaked scattering are prevalent in a variety of areas, including astrophysics, medical physics, and plasma physics \\cite{HGK,aristova,multiphysics}.\nFor these problems, solutions of the transport equation converge slowly when using conventional methods such as source iteration (SI) \\cite{adamslarsen} and the generalized minimal residual method (GMRES) \\cite{gmres}.\nMoreover, diffusion-based acceleration techniques like diffusion synthetic acceleration (DSA) \\cite{alcouffe} and nonlinear diffusion acceleration (NDA) \\cite{smithetall} are generally inefficient when tackling these problems, as they only accelerate up to the first moment of the angular flux \\cite{JapanFPSA}.\nIn fact, higher-order moments carry important information in problems with highly forward-peaked scattering and can be used to further accelerate convergence \\cite{japanDiss}.\n\nThis paper focuses on solution methods for the monoenergetic, steady-state transport equation in homogeneous slab geometry.\nUnder these conditions, the transport equation is given by\n\\begin{subequations}\\label[pluraleq]{eq1}\n\\begin{equation}\n\\label{t1}\n\\mu\\frac{\\partial}{\\partial x} \\psi(x,\\mu) + \\sigma_t \\psi(x,\\mu) = \\int_{-1}^{1} d\\mu' \\sigma_s(\\mu,\\mu') \\psi(x,\\mu') + Q(x, \\mu), \\,\\,\\, x\\in [0, X],-1\\leq\\mu\\leq 1  ,\\\\\n\\end{equation}\nwith boundary conditions\n\\begin{align}\n\\label{t2}\n\\psi(0,\\mu) &= \\psi_L(\\mu), \\quad \\mu > 0,\\\\\n\\label{t3}\n\\psi(X,\\mu) &= \\psi_R(\\mu), \\quad \\mu < 0.\n\\end{align}\n\\end{subequations}\nHere, $\\psi(x,\\mu)$ represents the angular flux at position $x$ and direction $\\mu$, $\\sigma_t$ is the macroscopic total cross section, $\\sigma_s(\\mu,\\mu')$ is the differential scattering cross section, and $Q$ is an internal source.\n\nNew innovations have paved the way to better solve this equation in systems with highly forward-peaked scattering.\nFor instance, work has been done on modified $P_L$ equations and modified scattering cross section moments to accelerate convergence of anisotropic neutron transport problems \\cite{khattab}.\nIn order to speed up the convergence of radiative transfer in clouds, a quasi-diffusion method has been developed \\cite{aristova}.\nIn addition, the DSA-multigrid method was developed to solve problems in electron transport more efficiently \\cite{trucksin}.\n\nOne of the most recent convergence methods developed is Fokker-Planck Synthetic Acceleration (FPSA) \\cite{JapanFPSA,japanDiss}.\nFPSA accelerates up to $N$ moments of the angular flux and has shown significant improvement in the convergence rate for the types of problems described above.\nThe method returns a speed-up of several orders of magnitude with respect to wall-clock time when compared to DSA  \\cite{JapanFPSA}.\n\nIn this paper, we introduce a new acceleration technique, called \\textit{Nonlinear Fokker-Planck Acceleration} (NFPA).\nThis  method  returns  a  modified  Fokker-Planck (FP) equation  that  preserves  the  angular moments of the flux given by the transport  equation.\nThis preservation of moments is particularly appealing for applications to multiphysics problems \\cite{multiphysics}, in which the coupling between the transport physics and the other physics can be done through the (lower-order) FP equation.\nTo our knowledge, this is the first implementation of a numerical method that returns a Fokker-Planck-like equation that is discretely consistent with the linear Boltzmann equation.\n\nThis paper is organized as follows.\n\\Cref{sec2} starts with a brief description of FPSA.\nThen, we derive the NFPA scheme.\nIn \\cref{sec3}, we discuss the discretization schemes used in this work and present numerical results.\nThese are compared against standard acceleration techniques.\nWe conclude with a discussion in \\cref{sec4}.\n\n\\section{Fokker-Planck Acceleration}\\label{sec2}\n\\setcounter{equation}{0} \nIn this section we briefly outline the theory behind FPSA, describe NFPA for monoenergetic, steady-state transport problems in slab geometry, and present the numerical methodology behind NFPA.\nThe theory given here can be easily extended to higher-dimensional problems.\nMoreover, extending the method to energy-dependence shall not lead to significant additional theoretical difficulties.\n\nTo solve the transport problem given by \\cref{eq1} we approximate the in-scattering term in \\cref{t1} with a Legendre moment expansion:\n\\begin{equation}\n\\label{transport1}\n\\mu\\frac{\\partial}{\\partial x} \\psi(x,\\mu) + \\sigma_t \\psi(x,\\mu) = \\sum_{l=0}^L \\frac{(2l+1)}{2} P_l(\\mu) \\sigma_{s,l} \\phi_l(x) + Q(x, \\mu),\n\\end{equation}\nwith \n\\begin{equation}\n\\label{transport2}\n\\phi_l(x) =  \\int_{-1}^{1} d\\mu P_l(\\mu) \\psi(x,\\mu).\n\\end{equation}\nHere, $\\phi_l$ is the $l^{th}$ Legendre moment of the angular flux, $ \\sigma_{s,l}$ is the $l^{th}$ Legendre coefficient of the differential scattering cross section,  and $P_l$ is the $l^{th}$-order Legendre polynomial.\nFor simplicity, we will drop the notation $(x,\\mu)$ in the remainder of this section.\n\nThe solution to \\cref{transport1} converges asymptotically to the solution of the following Fokker-Planck equation in the forward-peaked limit \\cite{pomraning1}:\n\\begin{equation}\n\\label{fp1}\n\\mu\\frac{\\partial \\psi}{\\partial x} + \\sigma_a \\psi = \\frac{\\sigma_{tr}}{2}\\frac{\\partial }{\\partial \\mu} (1-\\mu^2) \\frac{\\partial \\psi}{\\partial \\mu} + Q\\,,\n\\end{equation}\nwhere $\\sigma_{tr}= \\sigma_{s,0} -\\sigma_{s,1}$ is the momentum transfer cross section and $\\sigma_a = \\sigma_t-\\sigma_{s,0}$ is the macroscopic absorption cross section.\n\nSource Iteration \\cite{adamslarsen} is generally used to solve \\cref{transport1}, which can be rewritten in operator notation:\n\\begin{equation}\n\\label{si1}\n\\mathcal{L} \\psi^{m+1} = \\mathcal{S} \\psi^{m} + Q\\,,\n\\end{equation}\nwhere \n\\begin{equation}\n\\mathcal{L} = \\mu \\frac{\\partial}{\\partial x} + \\sigma_t,\n   \\quad\n\\mathcal{S} = \\sum_{l=0}^L \\frac{(2l+1)}{2} P_l(\\mu) \\sigma_{s,l} \\int_{-1}^{1}d\\mu P_l(\\mu) ,\n\\label{trans1}\n\\end{equation}\nand $m$ is the iteration index.\nThis equation is solved iteratively until a tolerance criterion is met. The FP approximation shown in \\cref{fp1} can be used to accelerate the convergence of \\cref{transport1}.\n\n\\subsection{FPSA: Fokker-Planck Synthetic Acceleration}\\label{FPSA}\n\nIn the FPSA scheme \\cite{JapanFPSA,japanDiss}, the FP approximation is used as a preconditioner to synthetically accelerate convergence when solving \\cref{transport1} (cf. \\cite{adamslarsen} for a detailed description of synthetic acceleration).\nWhen solving \\cref{si1}, the angular flux at each iteration $m$ has an error associated with it.\nFPSA systematically follows a predict, correct, iterate scheme.\nA transport sweep, one iteration in \\cref{si1}, is made for a prediction.\nThe FP approximation is used to correct the error in the prediction, and this iteration is performed until a convergence criterion is met.\nThe equations used are:\n\\begin{subequations}\n\\label{fpsaeq}\n\\begin{align}\n\\label{predict}\n\\mathrm{Predict}&: \\mathcal{L} \\psi^{m+\\frac{1}{2}} = \\mathcal{S} \\psi^{m} + Q\\,,\\\\\n\\label{correct}\n\\mathrm{Correct}&: \\psi^{m+1} =  \\psi^{m+\\frac{1}{2}} + \\mathcal{P}^{-1} \\mathcal{S} \\left( \\psi^{m+\\frac{1}{2}} -  \\psi^{m}\\right),\n\\end{align}\n\\end{subequations}\nwhere we define $\\mathcal{P}$ as\n\\begin{equation}\n\\label{FPSAsi1}\n\\mathcal{P} = \\mathcal{A}-\\mathcal{F} =\\underbrace{\\left(\\mu\\frac{\\partial}{\\partial x} + \\sigma_a\\right)}_\\mathcal{A} - \\underbrace{\\left(\\frac{\\sigma_{tr}}{2}\\frac{\\partial }{\\partial \\mu} (1-\\mu^2) \\frac{\\partial }{\\partial \\mu}\\right)}_\\mathcal{F},\n\\end{equation}\nIn this synthetic acceleration method, the FP approximation is used to correct the error in each iteration of the high-order (HO) equation (\\ref{predict}). \nTherefore, there is no consistency between the angular moments of the flux in the HO and low-order (LO) equations.\n\n\\subsection{NFPA: Nonlinear Fokker-Planck Acceleration}\\label{NFPA}\n\nSimilar to FPSA, NFPA uses the FP approximation to accelerate the convergence of the solution.\nWe introduce the additive term $\\hat{D}_F$ to \\cref{fp1}, obtaining the modified FP equation\n\\begin{equation}\n\\label{mfp1}\n\\mu\\frac{\\partial \\psi}{\\partial x} + \\sigma_a \\psi = \\frac{\\sigma_{tr}}{2}\\frac{\\partial }{\\partial \\mu} (1-\\mu^2) \\frac{\\partial \\psi}{\\partial \\mu} + \\hat{D}_F + Q\\,.\n\\end{equation}\nThe role of $\\hat{D}_F$ is to force the transport and modified FP equations to be consistent.\nSubtracting \\cref{mfp1} from \\cref{transport1} and rearranging, we obtain the consistency term\n\\begin{equation}\n\\label{dfp}\n\\hat{D}_F = \\sum_{l=0}^L \\frac{(2l+1)}{2} P_l \\sigma_l \\phi_l - \\frac{\\sigma_{tr}}{2}\\frac{\\partial}{\\partial \\mu} (1-\\mu^2) \\frac{\\partial \\psi}{\\partial \\mu} - \\sigma_{s,0} \\psi\\,.\n\\end{equation}\n\nThe NFPA method is given by the following equations:\n\\begin{subequations}\\label[pluraleq]{holocons}\n\\begin{align}\n\\label{HO1}\n\\text{HO}&: \\mu\\frac{\\partial \\psi_{HO}}{\\partial x} + \\sigma_t \\psi_{HO} = \\sum_{l=0}^L \\frac{(2l+1)}{2} P_l \\sigma_l \\phi_{l, LO} + Q\\,,\\\\\n\\label{LO11}\n\\text{LO}&: \\mu\\frac{\\partial \\psi_{LO}}{\\partial x} + \\sigma_a \\psi_{LO} = \\frac{\\sigma_{tr}}{2}\\frac{\\partial }{\\partial \\mu} (1-\\mu^2) \\frac{\\partial \\psi_{LO}}{\\partial \\mu} + \\hat{D}_F + Q\\,,\\\\\n\\label{con1}\n\\text{Consistency term}&: \\hat{D}_F = \\sum_{l=0}^L \\frac{(2l+1)}{2} P_l \\sigma_l \\phi_{l, HO}^m - \\frac{\\sigma_{tr}}{2}\\frac{\\partial }{\\partial \\mu} (1-\\mu^2) \\frac{\\partial \\psi_{HO}}{\\partial \\mu} - \\sigma_{s,0} \\psi_{HO}\\,,\n\\end{align}\n\\end{subequations}\nwhere $\\psi_{HO}$ is the angular flux obtained from the HO equation and $\\psi_{LO}$ is the angular flux obtained from the LO equation.\nThe nonlinear HOLO-plus-consistency system given by \\cref{holocons} can be solved using any nonlinear solution technique \\cite{kelley}. Note that the NFPA scheme returns a FP equation that is consistent with HO transport. \nMoreover, this modified FP equation accounts for large-angle scattering which the standard FP equation does not. \nThe LO equation (\\ref{fp1}) can then be integrated into multiphysics models in a similar fashion to standard HOLO schemes \\cite{patelFBR}. To solve the HOLO-plus-consistency system above, we use Picard iteration \\cite{kelley}:\n\\begin{subequations}\n\\begin{align}\n\\label{H1}\n\\text{Transport Sweep for HO}&:\n\\mathcal{L} \\psi_{HO}^{k+1} = \\mathcal{S} \\psi_{LO}^{k} + Q, \\\\\n\\label{L1}\n\\text{Evaluate Consistency Term}&: \\hat{D}_F^{k+1} = \\left(\\mathcal{S} - \\mathcal{F} - \\sigma_{s,0}\\mathcal{I}\\right) \\psi_{HO}^{k+1}, \\\\\n\\label{c1}\n\\text{Solve LO Equation}&: \\psi_{LO}^{k+1} = \\mathcal{P}^{-1} \\left(\\hat{D}_F^{k+1} + Q\\right), \n\\end{align}\n\\end{subequations}\nwhere $\\mathcal{L}$ and $\\mathcal{S}$ are given in \\cref{trans1}, $\\mathcal{P}$ and $\\mathcal{F}$ are given in \\cref{FPSAsi1}, $\\mathcal{I}$ is the identity operator, and $k$ is the iteration index.\nIteration is done until a convergence criterion is met.\n\nThe main advantage of setting up the LO equation in this fashion is that the stiffness matrix for LO needs to be setup and inverted \\textit{only once}, just as with FPSA \\cite{JapanFPSA, japanDiss}. This has a large impact on the method's performance.\nA flowchart of this algorithm is shown in \\cref{Nalgorithm}.\n\n\\begin{figure}[H]\n\\centering\n\\begin{tikzpicture}[node distance = 3cm, auto]\n   \n    \\node [block] (init) {Initial guess of flux moments};\n    \\node [cloud_HO, right of=init, node distance=4cm] (HOm) {HO};\n    \\node [cloud_LO, below of=HOm, node distance=2cm] (LOm) {LO};\n    \\node [HO, below of=init] (transport) {One sweep in transport equation};\n    \\node [decision, below of=transport,node distance=4cm] (decide) {Flux moments converged?};\n    \\node [LO, left of=decide, node distance=4cm] (dterm) {Solve for consistency term};\n    \\node [LO, left of=dterm, node distance=3cm] (MFP) {Solve for FP angular flux};\n    \\node [LO, above of=MFP, node distance=4cm] (moments) {Convert angular flux to moments};\n    \\node [block, right of=decide, node distance=4cm] (stop) {Stop};\n   \n    \\path [line] (init) -- (transport);\n    \\path [line] (transport) -- (decide);\n    \\path [line] (decide) -- node {no} (dterm);\n    \\path [line] (dterm) -- (MFP);\n    \\path [line] (MFP) -- (moments);\n    \\path [line] (moments) -- (transport);\n    \\path [line] (decide) -- node {yes}(stop);\n\\end{tikzpicture}\n\\caption{NFPA algorithm}\n\\label{Nalgorithm}\n\\end{figure}\n\n\\section{Numerical Experiments}\\label{sec3}\n\nIn \\cref{sec31} we describe the discretization methods used to implement the algorithms.\nIn \\cref{sec32} we provide numerical results for 2 different choices of source $Q$ and boundary conditions.\nFor each choice we solve the problem using 3 different scattering kernels, applying 3 different choices of parameters for each kernel.\nWe provide NFPA numerical results for these 18 cases and compare them against those obtained from FPSA and other standard methods.\n\nAll numerical experiments were performed using MATLAB.\nRuntime was tracked using the tic-toc functionality \\cite{matlab17}, with\nonly the solver runtime being taken into consideration in the comparisons.\nA 2017 MacBook Pro with a 2.8 GHz Quad-Core Intel Core i7 and 16 GB of RAM was used for all simulations.\n\n\n\\subsection{Discretization}\\label{sec31}\n\nThe Transport and FP equations were discretized using linear discontinuous finite element discretization in space \\cite{mpd1}, and discrete ordinates (S$_N$) in angle \\cite{landm}.\nThe Fokker-Planck operator $\\mathcal{F}$ was discretized using moment preserving discretization (MPD) \\cite{mpd1}.\nDetails of the derivation of the linear discontinuous finite element discretization can be seen in \\cite{japanDiss,martin}.\nThe finite element discretization for the  Fokker-Planck equation follows the same derivation.\n\nA brief review for the angular discretization used for the FP equation is given below.\nFirst, we use Gauss-Legendre quadrature to discretize the FP equation in angle:\n\\begin{equation}\n\\mu_n\\frac{\\partial \\psi_n(x)}{\\partial x} + \\sigma_a \\psi_n(x) - \\frac{\\sigma_{tr}}{2}\\nabla^2_n \\psi_n(x) =  Q_n(x),\n\\end{equation}\nfor $n=1,..,N$.\nHere, $\\nabla^2_n$ term is the discrete form of the angular Laplacian operator evaluated at angle $n$.\n\nThe MPD scheme is then shown as\n\\begin{equation}\n\\nabla^2_n \\psi_n = M \\psi_n = V^{-1} L V \\psi_n,\n\\end{equation}\nwhere $M$ is the MPD discretized operator defined by\n\\begin{subequations}\n\\begin{equation}\nV_{i,j} = P_{i-1}(\\mu_j)w_j,\n\\end{equation}\nand \n\\begin{equation}\nL_{i,j} = -i(i-1),\n\\end{equation}\n\\end{subequations}\nfor $i,j=1,...,N$.\nHere, $P_l(\\mu_j)$ are the Legendre polynomials evaluated at each angle $\\mu_j$ and $w_j$ are the respective weights.\n$M$ is defined as a (N x N) operator for a vector of $N$ angular fluxes $ \\psi(x)$, at spatial location $x$. \n\nIn summary, if we write the FP equation as\n\\begin{equation}\n\\mathcal{H} \\frac{\\partial \\psi}{\\partial x}(x) + \\sigma_a \\psi(x) - \\mathcal{F} \\psi(x) =  Q(x),\n\\end{equation}\nthen $\\mathcal{H}$ is Diag$(\\mu_n)$ for $n=1,...,N$, $Q(x)$ is a vector of source terms $Q_n(x)$, and $\\mathcal{F}$ is represented by $\\frac{\\sigma_{tr}}{2}M$.\n\n\n\\subsection{Numerical Results}\\label{sec32}\n\nIt is shown that for slowly converging problems, typical convergence methods like $L_\\infty$ suffer from false convergence \\cite{adamslarsen}.\nTo work around this issue, the criterion is modified to use information about the current and previous iteration:\n\\begin{equation}\n\\label{falseconverge}\n\\frac{|| \\phi^{m}_0(x) - \\phi^{m-1}_0(x) ||_2}{1-\\frac{|| \\phi^{m+1}_0(x) - \\phi^{m}_0(x) ||_2}{|| \\phi^{m}_0(x) - \\phi^{m-1}_0(x) ||_2}} < 10^{-8}.\n\\end{equation}\n\nTwo problems were tested using 200 spatial cells, $X$ = 400, $\\sigma_a = 0$, $L$ = 15, and $N$ = 16.\nProblem 1 has vacuum boundaries and a homogeneous isotropic source $Q$ for $0 < x < X$.\nProblem 2 has no internal source and an incoming beam at the left boundary. The source and boundary conditions used are shown in \\cref{parameters}. \n\\begin{table}[H]\n\\begin{center}\n\\scalebox{0.9}{\n\\begin{tabular}{c | c | c} \\hline \n& Problem 1 & Problem 2 \\\\ \\hline \\hline\nQ(x) & 0.5 & 0 \\\\\n$\\psi_L$ & 0 & $\\delta(\\mu - \\mu_N)$  \\\\\n$\\psi_R$ & 0 & 0 \\\\\n\\end{tabular}}\n\\end{center}\n\\caption{Problem Parameters}\n\\label{parameters} \n\\end{table} \nWe consider three scattering kernels in this paper: Screened Rutherford \\cite{pomraning1}, Exponential \\cite{pomraning2}, and Henyey-Greenstein \\cite{HGK}.\nThree cases for each kernel were tested.\nThe results obtained with NFPA are compared with those obtained using GMRES, DSA, and FPSA with the MPD scheme.\n\n\\subsubsection{SRK: Screened Rutherford Kernel}\n\nThe Screened Rutherford Kernel \\cite{pomraning1, JapanFPSA} is a widely used scattering kernel for modeling scattering behavior of electrons \\cite{SRK}.\nThe kernel depends on the parameter $\\eta$, such that\n\\begin{equation}\n\\sigma^{SRK}_{s,l} = \\sigma_s  \\int_{-1}^{1} d\\mu P_l(\\mu) \\frac{\\eta (\\eta+1)}{(1+2\\eta-\\mu)^2}.\n\\end{equation}\nThe SRK has a valid FP limit as $\\eta$ approaches 0 \\cite{patelFBR}. Three different values of $\\eta$ were used to generate the scattering kernels shown in \\cref{SRK}.\nGMRES, DSA, FPSA, and NFPA all converged to the same solution for problems 1 and 2. \\Cref{SRK_plots} shows the solutions for SRK with $\\eta = 10^{-7}$.\n\\begin{figure}[t]\n\\begin{center}\n  \\includegraphics[scale=0.1,angle=0]{SRK.jpg}\n  \\caption{Screened Rutherford Kernels}\n  \\label{SRK}\n\\end{center}\n\\end{figure}\n\\begin{figure}[H]\n    \\centering\n    \\subfloat[Problem 1]{{\\includegraphics[width=7cm]{s7_iso.jpg} }}\n    \\qquad\n    \\subfloat[Problem 2]{{\\includegraphics[width=7cm]{s7_beam.jpg} }}\n    \\caption{Results for SRK Problems with $\\eta = 10^{-7}$}\n    \\label{SRK_plots}\n\\end{figure}\n\n\\begin{table}[H]\n\\begin{center}\n\\scalebox{0.8}{\n\\begin{tabular}{c || c || c || c} \\hline \nParameter & Solver & Runtime (s) & Iterations \\\\ \\hline \\hline\n\\multirow{4}{*}{$\\eta = 10^{-5}$} & GMRES & 98.8 & 12 \\\\\n& DSA & 2380 & 53585 \\\\\n& FPSA & 1.21 & 26 \\\\\n& NFPA & 1.39 & 26 \\\\ \\hline \n\\multirow{4}{*}{$\\eta = 10^{-6}$} & GMRES & 208 & 84 \\\\\n& DSA & 3040 & 69156 \\\\\n& FPSA & 0.747 & 16 \\\\\n& NFPA & 0.857 & 16 \\\\ \\hline \n\\multirow{4}{*}{$\\eta = 10^{-7}$} & GMRES & 174 & 124 \\\\\n& DSA & 3270 & 73940 \\\\\n& FPSA & 0.475 & 10 \\\\\n& NFPA & 0.542 & 10 \\\\ \\hline\n\\end{tabular}}\n\\end{center}\n\\caption{Runtime and Iteration Counts for Problem 1 with SRK}\n\\label{SRKresults1} \n\\end{table}\n\\begin{table}[H]\n\\begin{center}\n\\scalebox{0.8}{\n\\begin{tabular}{c || c || c || c} \\hline \nParameter & Solver & Runtime (s) & Iterations \\\\ \\hline \\hline\n\\multirow{4}{*}{$\\eta = 10^{-5}$} & GMRES & 52.4 & 187 \\\\\n& DSA & 1107 & 25072 \\\\\n& FPSA & 0.953 & 20 \\\\\n& NFPA & 1.14 & 20 \\\\ \\hline \n\\multirow{4}{*}{$\\eta = 10^{-6}$} & GMRES & 108 & 71 \\\\\n& DSA & 1434 & 32562  \\\\\n& FPSA & 0.730 & 14 \\\\\n& NFPA & 0.857 & 14 \\\\ \\hline \n\\multirow{4}{*}{$\\eta = 10^{-7}$} & GMRES & 94.1 & 185 \\\\\n& DSA & 1470 & 33246 \\\\\n& FPSA & 0.438 & 8 \\\\\n& NFPA & 0.484 & 8 \\\\ \\hline  \n\\end{tabular}}\n\\end{center}\n\\caption{Runtime and Iteration Counts for Problem 2 with SRK}\n\\label{SRKresults2} \n\\end{table}\n\nThe results of all solvers are shown in \\cref{SRKresults1,SRKresults2}.\nWe see that NFPA and FPSA tremendously outperform GMRES and DSA in runtime for all cases.\nFPSA is a simpler method than NFPA, requiring less calculations per iteration; therefore, it is expected that it outperforms NFPA in runtime.\nWe see a reduction in runtime and iterations for FPSA and NFPA as the FP limit is approached, with DSA and GMRES requiring many more iterations by comparison as $\\eta$ approaches 0.\n\nAn advantage that NFPA offers is that the angular moments of the flux in the LO equation will remain consistent with those of the transport equation even as a problem becomes less forward-peaked.\nOn the other hand, the moments found using only the FP equation and source iteration lose accuracy.\nTo illustrate this, Problem 1 was tested using different Screened Rutherford Kernels with increasing $\\eta$ parameters.\nThe percent errors (relative to the transport solution) for the scalar flux obtained with the LO equation and with the standard FP equation at the center of the slab are shown in \\cref{momcomp}.\nIt can be seen that the percent relative errors in the scalar flux of the FP solution is orders of magnitude larger than the error produced using the LO equation.\nThe same trend can be seen when using the exponential and Henyey-Greenstein kernels. \n\n\\begin{figure}[H]\n\\begin{center}\n  \\includegraphics[scale=0.15,angle=0]{relerrorlog.jpg}\n  \\caption{Log Scale of $\\%$ Relative Error vs $\\eta$ for Problem 1 at the Center of the Slab with SRK}\n  \\label{momcomp}\n\\end{center}\n\\end{figure}\n\n\\subsubsection{EK: Exponential Kernel}\n\nThe exponential kernel \\cite{pomraning2, JapanFPSA} is a fictitious kernel made for problems that have a valid Fokker-Planck limit \\cite{pomraning1}.\nThe zero$^{\\text{th}}$ moment, $\\sigma^{EK}_{s,0}$, is chosen arbitrarily; we define $\\sigma^{EK}_{s,0}$ as the same zero$^{\\text{th}}$ moment from the SRK.\nThe $\\Delta$ parameter determines the kernel: the first and second moments are given by \n\\begin{subequations}\n\\begin{align}\n\\sigma^{EK}_{s,1} &= \\sigma^{EK}_{s,0} (1-\\Delta),\\\\\n\\sigma^{EK}_{s,2} &= \\sigma^{EK}_{s,0} (1-3\\Delta+3\\Delta^2),\n\\end{align}\nand the relationship for $l\\geq 3$ is\n\\begin{equation}\n\\sigma^{EK}_{s,l} = \\sigma^{EK}_{s,l-2} - \\Delta(2l+1) \\sigma^{EK}_{s,l-1}.\n\\end{equation}\n\\end{subequations}\nAs $\\Delta$ is reduced, the scattering kernel becomes more forward-peaked.\n\nThe EK has a valid FP limit as $\\Delta$ approaches 0 \\cite{patelFBR}.\nThree different values of $\\Delta$ were used to generate the scattering kernels shown in \\cref{EXP}.\nThe generated scattering kernels are shown in \\cref{EXP}.\nGMRES, DSA, FPSA, and NFPA all converged to the same solution for problems 1 and 2.\n\\Cref{EK_plots} shows the solutions for EK with $\\Delta = 10^{-7}$.\n\\begin{figure}[t]\n\\begin{center}\n  \\includegraphics[scale=0.1,angle=0]{EXP.jpg}\n  \\caption{Exponential Kernels}\n  \\label{EXP}\n\\end{center}\n\\end{figure}\n\\begin{figure}[H]\n    \\centering\n    \\subfloat[Problem 1]{{\\includegraphics[width=7cm]{dta7_iso.jpg} }}\n    \\qquad\n    \\subfloat[Problem 2]{{\\includegraphics[width=7cm]{dta7_beam.jpg} }}\n    \\caption{Results for EK Problems with $\\Delta = 10^{-7}$}\n    \\label{EK_plots}\n\\end{figure}\n\nThe runtimes and iterations for GMRES, DSA, FPSA, and NFPA are shown in \\cref{Expresults1,Expresults2}.\nWe see a similar trend with the EK as seen with SRK.\nSmaller $\\Delta$ values lead to a reduction in runtime and iterations for NFPA and FPSA, which greatly outperform DSA and GMRES in both categories.\n\n\\begin{table}[h]\n\\begin{center}\n\\scalebox{0.8}{\n\\begin{tabular}{c || c || c || c} \\hline \nParameter & Solver & Runtime (s) & Iterations \\\\ \\hline \\hline\n\\multirow{4}{*}{$\\Delta = 10^{-5}$} & GMRES & 196 & 142 \\\\\n& DSA & 3110 & 70140 \\\\\n& FPSA & 0.514 & 11 \\\\ \n& NFPA & 0.630 & 11 \\\\\\hline \n\\multirow{4}{*}{$\\Delta = 10^{-6}$} & GMRES & 156 & 132 \\\\\n& DSA & 3120 & 70758 \\\\\n& FPSA & 0.388 & 7 \\\\ \n& NFPA & 0.393 & 7 \\\\ \\hline \n\\multirow{4}{*}{$\\Delta = 10^{-7}$} & GMRES & 81 & 127 \\\\\n& DSA & 3120 & 70851  \\\\\n& FPSA & 0.292 & 6 \\\\ \n& NFPA & 0.318 & 6 \\\\ \\hline\n\\end{tabular}}\n\\end{center}\n\\caption{Runtime and Iteration Counts for Problem 1 with EK}\n\\label{Expresults1} \n\\end{table}\n\\begin{table}[h]\n\\begin{center}\n\\scalebox{0.8}{\n\\begin{tabular}{c || c || c || c} \\hline \nParameter & Solver & Runtime (s) & Iterations \\\\ \\hline \\hline\n\\multirow{4}{*}{$\\Delta = 10^{-5}$} & GMRES & 110 & 73 \\\\\n& DSA & 1455 & 33033 \\\\\n& FPSA & 0.492 & 10 \\\\ \n& NFPA & 0.613 & 10 \\\\ \\hline \n\\multirow{4}{*}{$\\Delta = 10^{-6}$} & GMRES & 82.7 & 79 \\\\\n& DSA & 1470 & 33309 \\\\\n& FPSA & 0.358 & 7 \\\\ \n& NFPA & 0.431 & 7 \\\\ \\hline \n\\multirow{4}{*}{$\\Delta = 10^{-7}$} & GMRES & 56.8 & 90 \\\\\n& DSA & 1470 & 33339 \\\\\n& FPSA & 0.273 & 5 \\\\ \n& NFPA & 0.319 & 5 \\\\ \\hline  \n\\end{tabular}}\n\\end{center}\n\\caption{Runtime and Iteration Counts for Problem 2 with EK}\n\\label{Expresults2} \n\\end{table}\n\n\\subsubsection{HGK: Henyey-Greenstein Kernel}\n\nThe Henyey-Greenstein Kernel \\cite{HGK,JapanFPSA} is most commonly used in light transport in clouds.\nIt relies on the anisotropy factor $g$, such that\n\\begin{equation}\n\\sigma^{HGK}_{s,l} = \\sigma_s g^l.\n\\end{equation}\nAs $g$ goes from zero to unity, the scattering shifts from isotropic to highly anisotropic.\n\\begin{figure}[H]\n\\begin{center}\n  \\includegraphics[scale=0.1,angle=0]{HGK.jpg}\n  \\caption{Henyey-Greenstein Kernels}\n  \\label{HGK}\n\\end{center}\n\\end{figure}\n\\begin{figure}[H]\n    \\centering\n    \\subfloat[Problem 1]{{\\includegraphics[width=7cm]{g099_iso.jpg} }}\n    \\qquad\n    \\subfloat[Problem 2]{{\\includegraphics[width=7cm]{g099_beam.jpg} }}\n    \\caption{Results for HGK Problems with $g = 0.99$}\n    \\label{HGK_plots}\n\\end{figure}\n\n\nThe HGK does not have a valid FP limit \\cite{patelFBR}.\nThe three kernels tested are shown in \\cref{HGK}.\nGMRES, DSA, FPSA, and NFPA all converged to the same solution for problems 1 and 2.\n\\Cref{HGK_plots} shows the solutions for HGK with $g = 0.99$.\nThe results of each solver are shown in \\cref{HGKresults1,HGKresults2}. \n\\begin{table}[h]\n\\begin{center}\n\\scalebox{0.8}{\n\\begin{tabular}{c || c || c || c} \\hline \nParameter & Solver & Runtime (s) & Iterations \\\\ \\hline \\hline\n\\multirow{4}{*}{$g=0.9$} & GMRES & 9.88 & 76 \\\\\n& DSA & 24.5 & 554 \\\\\n& FPSA & 1.50 & 32 \\\\ \n& NFPA & 1.39 & 27 \\\\ \\hline \n\\multirow{4}{*}{$g=0.95$} & GMRES & 12.2 & 131 \\\\\n& DSA & 47.7 & 1083 \\\\\n& FPSA & 1.75 & 38 \\\\ \n& NFPA & 1.83 & 35 \\\\ \\hline \n\\multirow{4}{*}{$g=0.99$} & GMRES & 40.0 & 27 \\\\\n& DSA & 243 & 5530  \\\\\n& FPSA & 3.38 & 74 \\\\ \n& NFPA & 3.93 & 73 \\\\ \\hline\n\\end{tabular}}\n\\end{center}\n\\caption{Runtime and Iteration Counts for Problem 1 with HGK}\n\\label{HGKresults1} \n\\end{table}\n\\begin{table}[h]\n\\begin{center}\n\\scalebox{0.8}{\n\\begin{tabular}{c || c || c || c} \\hline \nParameter & Solver & Runtime (s) & Iterations \\\\ \\hline \\hline\n\\multirow{4}{*}{$g=0.9$} & GMRES & 24.3 & 135 \\\\\n& DSA & 14.8 & 336  \\\\\n& FPSA & 1.15 & 23 \\\\ \n& NFPA & 1.35 & 24 \\\\ \\hline \n\\multirow{4}{*}{$g=0.95$} & GMRES & 31.3 & 107 \\\\\n& DSA & 29.7 & 675 \\\\\n& FPSA & 1.56 & 32 \\\\ \n& NFPA & 1.90 & 33 \\\\ \\hline \n\\multirow{4}{*}{$g=0.99$} & GMRES & 41.4 & 126 \\\\\n& DSA & 146 & 3345 \\\\\n& FPSA & 3.31 & 67 \\\\ \n& NFPA & 3.99 & 67 \\\\ \\hline  \n\\end{tabular}}\n\\end{center}\n\\caption{Runtime and Iteration Counts for Problem 2 with HGK}\n\\label{HGKresults2} \n\\end{table}\n\nHere we see that NFPA and FPSA do not perform as well compared to their results for the SRK and EK.\nContrary to what happened in those cases, both solvers require more time and iterations as the problem becomes more anisotropic.\nThis is somewhat expected, due to HGK not having a valid Fokker-Planck limit.\nHowever, both NFPA and FPSA continue to greatly outperform GMRES and DSA.\nMoreover, NFPA outperforms FPSA in iteration count for problem 1.\n\n\n\\section{Discussion}\\label{sec4}\n\nThis paper introduced the Nonlinear Fokker-Planck Acceleration technique for steady-state, monoenergetic transport in homogeneous slab geometry.\nTo our knowledge, this is the first nonlinear HOLO method that accelerates \\textit{all $L$ moments} of the angular flux.\nUpon convergence, the LO and HO models are consistent; in other words, the (lower-order) modified Fokker-Planck equation \\textit{preserves the same angular moments} of the flux obtained with the (higher-order) transport equation.\n\nNFPA was tested on a homogeneous medium with an isotropic internal source with vacuum boundaries, and in a homogeneous medium with no internal source and an incoming beam boundary.\nFor both problems, three different scattering kernels were used.\nThe runtime and iterations of NFPA and FPSA were shown to be similar.\nThey both vastly outperformed DSA and GMRES for all cases by orders of magnitude.\nHowever, NFPA has the feature of preserving the angular moments of the flux in both the HO and LO equations, which offers the advantage of integrating the LO model into multiphysics models. \n\nIn the future, we intend to test NFPA capabilities for a variety of multiphysics problems and analyze its performance.\nTo apply NFPA to more realistic problems, it needs to be extended to include time and energy dependence. \nAdditionally, the method needs to be adapted to address geometries with higher-order spatial dimensions.\nFinally, for the NFPA method to become mathematically ``complete\", a full convergence examination using Fourier analysis must be performed.\nHowever, this is beyond the scope of this paper and must be left for future work.\n\n\\section*{Acknowledgements}\n\nThe authors acknowledge support under award number NRC-HQ-84-15-G-0024 from the Nuclear Regulatory Commission.\nThe statements, findings, conclusions, and recommendations are those of the authors and do not necessarily reflect the view of the U.S. Nuclear Regulatory Commission.\n\nJ.~K. Patel would like to thank Dr.~James Warsa for his wonderful transport class at UNM, as well as his synthetic acceleration codes.\nThe authors would also like to thank Dr.~Anil Prinja for discussions involving Fokker-Planck acceleration.\n\n\n\n",
    "answers": [
        "NFPA and FPSA greatly outperform GMRES and DSA."
    ],
    "length": 3996,
    "dataset": "multifieldqa_en",
    "language": "en",
    "all_classes": null,
    "_id": "a40877e222497d3ff2efbeb1926e20600f8aac947820063c"
}